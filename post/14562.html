<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>测试记录 | Miij's Blog</title><meta name="description" content="测试记录"><meta name="keywords" content="linux"><meta name="author" content="曹志明"><meta name="copyright" content="曹志明"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="测试记录"><meta name="twitter:description" content="测试记录"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="测试记录"><meta property="og:url" content="https://caohziming.net/post/14562"><meta property="og:site_name" content="Miij's Blog"><meta property="og:description" content="测试记录"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = '2'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://caohziming.net/post/14562"><link rel="prev" title="Nginx编译安装" href="https://caohziming.net/post/31024.html"><link rel="next" title="三次握手及四次挥手" href="https://caohziming.net/post/15747.html"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: 曹志明","link":"链接: https://caohziming.net/post/14562","source":"来源: Miij's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.1.1"><link rel="alternate" href="/atom.xml" title="Miij's Blog" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Miij's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">7</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">7</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-请写出-5-个你熟悉的-Linux-软件服务的网络端口号和对应的软件名称。"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">1. 请写出 5 个你熟悉的 Linux 软件服务的网络端口号和对应的软件名称。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-使用-ansible-playbook-创建-20-个普通用户，用户名为-magedu01-到-magedu20，用户密码为Linux2019-39"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">2. 使用 ansible playbook 创建 20 个普通用户，用户名为 magedu01 到 magedu20，用户密码为Linux2019@39</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-使用-crontab-任务计划，在每月22号晚上-9-点到晚上-11-点之间每-5-钟执行一次-root-backup-sh-脚本文件"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">3. 使用 crontab 任务计划，在每月22号晚上 9 点到晚上 11 点之间每 5 钟执行一次 &#x2F;root&#x2F;backup.sh 脚本文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#4-请写出在-CentOS6-10-和-Ubuntu1804-版本中永久修改主机名为-magedu-org-过程"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">4. 请写出在 CentOS6.10 和 Ubuntu1804 版本中永久修改主机名为 magedu.org 过程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#5-请写出-CentOS6-10，CentOS7-7，Ubuntu1804-中配置静态网络地址的过程，ip-地址为-192-168-100-100-子网掩码为-255-255-255-0"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">5. 请写出 CentOS6.10，CentOS7.7，Ubuntu1804 中配置静态网络地址的过程，ip 地址为 192.168.100.100 子网掩码为 255.255.255.0</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#6-请说出为什么在-ping-服务器地址时不需要指明端口号的原因"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">6. 请说出为什么在 ping 服务器地址时不需要指明端口号的原因</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#7-使用-awk-统计统计处理以下文件中每种域名出现的次数"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">7. 使用 awk 统计统计处理以下文件中每种域名出现的次数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#8-CentOS7-6-系统中如何禁用-firewalld-服务？-禁用-firewalld-后，请写出-iptables-规则，要求仅对外开放-TCP-协议的-22、80、443-端口-配置生效后，如何才能确保系统重启后自动完成刚才的-iptables-规则配置？"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">8. CentOS7.6 系统中如何禁用 firewalld 服务？ 禁用 firewalld 后，请写出 iptables 规则，要求仅对外开放 TCP 协议的 22、80、443 端口; 配置生效后，如何才能确保系统重启后自动完成刚才的 iptables 规则配置？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#9-请简述-httpd-的三种工作模式以及他们的特点（prefork-worker-Event）"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text">9. 请简述 httpd 的三种工作模式以及他们的特点（prefork, worker, Event）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#10-CentOS7-系统有几个运行级别？-分别是什么？-如何将默认运行级别调整为字符界面？"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text">10. CentOS7 系统有几个运行级别？ 分别是什么？ 如何将默认运行级别调整为字符界面？</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#扩展题"><span class="toc_mobile_items-number"></span> <span class="toc_mobile_items-text">扩展题</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-使用-shell-脚本完成在一台-CentOS7-中编译安装-httpd2-4-39-和-php7-3-5-的-fpm-模式，实现-httpd-通过-socket-与-fpm-通信，-响应-phpinfo-信息页面请求，请写出详细过程。"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">1. 使用 shell 脚本完成在一台 CentOS7 中编译安装 httpd2.4.39 和 php7.3.5 的 fpm 模式，实现 httpd 通过 socket 与 fpm 通信， 响应 phpinfo 信息页面请求，请写出详细过程。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-httpd-服务器的访问日志保存在容量为-1T-的-dev-sdb-磁盘中，对应的挂载路径为-data-log，编写一个-shell-脚本，每隔一个小时测试一下该磁盘的使用率是否超过60-，如果超过立刻将-2-天之前的日志移动到远程服务器-172-18-0-100-服务器上，移动完成后，如果磁盘空间使用率依旧大于-70-则发邮件给-1794379915-qq-com-提示报警。请写出操作的主要过程。"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">2. httpd 服务器的访问日志保存在容量为 1T 的 &#x2F;dev&#x2F;sdb 磁盘中，对应的挂载路径为&#x2F;data&#x2F;log，编写一个 shell 脚本，每隔一个小时测试一下该磁盘的使用率是否超过60%，如果超过立刻将 2 天之前的日志移动到远程服务器 172.18.0.100 服务器上，移动完成后，如果磁盘空间使用率依旧大于 70%, 则发邮件给 1794379915@qq.com 提示报警。请写出操作的主要过程。</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-请写出-5-个你熟悉的-Linux-软件服务的网络端口号和对应的软件名称。"><span class="toc-number">1.</span> <span class="toc-text">1. 请写出 5 个你熟悉的 Linux 软件服务的网络端口号和对应的软件名称。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-使用-ansible-playbook-创建-20-个普通用户，用户名为-magedu01-到-magedu20，用户密码为Linux2019-39"><span class="toc-number">2.</span> <span class="toc-text">2. 使用 ansible playbook 创建 20 个普通用户，用户名为 magedu01 到 magedu20，用户密码为Linux2019@39</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-使用-crontab-任务计划，在每月22号晚上-9-点到晚上-11-点之间每-5-钟执行一次-root-backup-sh-脚本文件"><span class="toc-number">3.</span> <span class="toc-text">3. 使用 crontab 任务计划，在每月22号晚上 9 点到晚上 11 点之间每 5 钟执行一次 &#x2F;root&#x2F;backup.sh 脚本文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-请写出在-CentOS6-10-和-Ubuntu1804-版本中永久修改主机名为-magedu-org-过程"><span class="toc-number">4.</span> <span class="toc-text">4. 请写出在 CentOS6.10 和 Ubuntu1804 版本中永久修改主机名为 magedu.org 过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-请写出-CentOS6-10，CentOS7-7，Ubuntu1804-中配置静态网络地址的过程，ip-地址为-192-168-100-100-子网掩码为-255-255-255-0"><span class="toc-number">5.</span> <span class="toc-text">5. 请写出 CentOS6.10，CentOS7.7，Ubuntu1804 中配置静态网络地址的过程，ip 地址为 192.168.100.100 子网掩码为 255.255.255.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-请说出为什么在-ping-服务器地址时不需要指明端口号的原因"><span class="toc-number">6.</span> <span class="toc-text">6. 请说出为什么在 ping 服务器地址时不需要指明端口号的原因</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-使用-awk-统计统计处理以下文件中每种域名出现的次数"><span class="toc-number">7.</span> <span class="toc-text">7. 使用 awk 统计统计处理以下文件中每种域名出现的次数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-CentOS7-6-系统中如何禁用-firewalld-服务？-禁用-firewalld-后，请写出-iptables-规则，要求仅对外开放-TCP-协议的-22、80、443-端口-配置生效后，如何才能确保系统重启后自动完成刚才的-iptables-规则配置？"><span class="toc-number">8.</span> <span class="toc-text">8. CentOS7.6 系统中如何禁用 firewalld 服务？ 禁用 firewalld 后，请写出 iptables 规则，要求仅对外开放 TCP 协议的 22、80、443 端口; 配置生效后，如何才能确保系统重启后自动完成刚才的 iptables 规则配置？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-请简述-httpd-的三种工作模式以及他们的特点（prefork-worker-Event）"><span class="toc-number">9.</span> <span class="toc-text">9. 请简述 httpd 的三种工作模式以及他们的特点（prefork, worker, Event）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-CentOS7-系统有几个运行级别？-分别是什么？-如何将默认运行级别调整为字符界面？"><span class="toc-number">10.</span> <span class="toc-text">10. CentOS7 系统有几个运行级别？ 分别是什么？ 如何将默认运行级别调整为字符界面？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扩展题"><span class="toc-number"></span> <span class="toc-text">扩展题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-使用-shell-脚本完成在一台-CentOS7-中编译安装-httpd2-4-39-和-php7-3-5-的-fpm-模式，实现-httpd-通过-socket-与-fpm-通信，-响应-phpinfo-信息页面请求，请写出详细过程。"><span class="toc-number">1.</span> <span class="toc-text">1. 使用 shell 脚本完成在一台 CentOS7 中编译安装 httpd2.4.39 和 php7.3.5 的 fpm 模式，实现 httpd 通过 socket 与 fpm 通信， 响应 phpinfo 信息页面请求，请写出详细过程。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-httpd-服务器的访问日志保存在容量为-1T-的-dev-sdb-磁盘中，对应的挂载路径为-data-log，编写一个-shell-脚本，每隔一个小时测试一下该磁盘的使用率是否超过60-，如果超过立刻将-2-天之前的日志移动到远程服务器-172-18-0-100-服务器上，移动完成后，如果磁盘空间使用率依旧大于-70-则发邮件给-1794379915-qq-com-提示报警。请写出操作的主要过程。"><span class="toc-number">2.</span> <span class="toc-text">2. httpd 服务器的访问日志保存在容量为 1T 的 &#x2F;dev&#x2F;sdb 磁盘中，对应的挂载路径为&#x2F;data&#x2F;log，编写一个 shell 脚本，每隔一个小时测试一下该磁盘的使用率是否超过60%，如果超过立刻将 2 天之前的日志移动到远程服务器 172.18.0.100 服务器上，移动完成后，如果磁盘空间使用率依旧大于 70%, 则发邮件给 1794379915@qq.com 提示报警。请写出操作的主要过程。</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">测试记录</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2019-12-30<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2019-12-30</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/linux/">linux</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.3k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 16 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h4 id="1-请写出-5-个你熟悉的-Linux-软件服务的网络端口号和对应的软件名称。"><a href="#1-请写出-5-个你熟悉的-Linux-软件服务的网络端口号和对应的软件名称。" class="headerlink" title="1. 请写出 5 个你熟悉的 Linux 软件服务的网络端口号和对应的软件名称。"></a>1. 请写出 5 个你熟悉的 Linux 软件服务的网络端口号和对应的软件名称。</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参考答案：</span><br><span class="line">21 ftp</span><br><span class="line">22 sshd</span><br><span class="line">25 smtp</span><br><span class="line">53 dns</span><br><span class="line">80 httpd</span><br><span class="line">443 httpd</span><br><span class="line">3306 mysql</span><br></pre></td></tr></table></figure></div>

<h4 id="2-使用-ansible-playbook-创建-20-个普通用户，用户名为-magedu01-到-magedu20，用户密码为Linux2019-39"><a href="#2-使用-ansible-playbook-创建-20-个普通用户，用户名为-magedu01-到-magedu20，用户密码为Linux2019-39" class="headerlink" title="2. 使用 ansible playbook 创建 20 个普通用户，用户名为 magedu01 到 magedu20，用户密码为Linux2019@39"></a>2. 使用 ansible playbook 创建 20 个普通用户，用户名为 magedu01 到 magedu20，用户密码为Linux2019@39</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># passwd gordon</span></span><br><span class="line">Changing password <span class="keyword">for</span> user gordon.</span><br><span class="line">New password: </span><br><span class="line">Retype new password: </span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/shadow | grep gordon</span></span><br><span class="line">gordon:<span class="variable">$6</span><span class="variable">$f6IXT17v</span><span class="variable">$CrNtB1iwvkDfO6tYinmZlWSpW04s2sEUv</span>/nAup.2idc5r.RaF0jKUDj35MwtT6E6WNybNNEnrFz/JvzLFDdFw.:18260:0:99999:7:::</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat user.yml </span></span><br><span class="line">---</span><br><span class="line">- hosts: all</span><br><span class="line">  remote_user: root</span><br><span class="line">  </span><br><span class="line">  tasks:</span><br><span class="line">    - name: create user</span><br><span class="line">      user:</span><br><span class="line">        name: <span class="string">"&#123;&#123;item&#125;&#125;"</span></span><br><span class="line">        password: <span class="string">'$6$f6IXT17v$CrNtB1iwvkDfO6tYinmZlWSpW04s2sEUv/nAup.2idc5r.RaF0jKUDj35MwtT6E6WNybNNEnrFz/JvzLFDdFw.'</span></span><br><span class="line">      with_sequence: start=1 end=20 stride=1 format=<span class="string">"magedu%02d"</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h4 id="3-使用-crontab-任务计划，在每月22号晚上-9-点到晚上-11-点之间每-5-钟执行一次-root-backup-sh-脚本文件"><a href="#3-使用-crontab-任务计划，在每月22号晚上-9-点到晚上-11-点之间每-5-钟执行一次-root-backup-sh-脚本文件" class="headerlink" title="3. 使用 crontab 任务计划，在每月22号晚上 9 点到晚上 11 点之间每 5 钟执行一次 /root/backup.sh 脚本文件"></a>3. 使用 crontab 任务计划，在每月22号晚上 9 点到晚上 11 点之间每 5 钟执行一次 /root/backup.sh 脚本文件</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/5 21-22 22 * * /bin/bash  /root/backup.sh  &gt; /dev/null</span><br></pre></td></tr></table></figure></div>

<h4 id="4-请写出在-CentOS6-10-和-Ubuntu1804-版本中永久修改主机名为-magedu-org-过程"><a href="#4-请写出在-CentOS6-10-和-Ubuntu1804-版本中永久修改主机名为-magedu-org-过程" class="headerlink" title="4. 请写出在 CentOS6.10 和 Ubuntu1804 版本中永久修改主机名为 magedu.org 过程"></a>4. 请写出在 CentOS6.10 和 Ubuntu1804 版本中永久修改主机名为 magedu.org 过程</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">CentOS6.10 :</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># hostname</span></span><br><span class="line">localhost</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># hostname magedu.org</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># hostname</span></span><br><span class="line">magedu.org</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/sysconfig/network</span></span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=magedu.org</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ubuntu1804 :</span><br><span class="line"></span><br><span class="line">root@localhost:~<span class="comment"># </span></span><br><span class="line">root@localhost:~<span class="comment"># hostname</span></span><br><span class="line">localhost</span><br><span class="line">root@localhost:~<span class="comment"># </span></span><br><span class="line">root@localhost:~<span class="comment"># </span></span><br><span class="line">root@localhost:~<span class="comment"># hostnamectl set-hostname magedu.org</span></span><br><span class="line">root@localhost:~<span class="comment"># </span></span><br><span class="line">root@localhost:~<span class="comment"># hostname</span></span><br><span class="line">magedu.org</span><br><span class="line">root@localhost:~<span class="comment">#</span></span><br><span class="line">root@localhost:~<span class="comment"># cat /etc/hostname </span></span><br><span class="line">magedu.org</span><br><span class="line">root@localhost:~<span class="comment"># </span></span><br><span class="line">root@localhost:~<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h4 id="5-请写出-CentOS6-10，CentOS7-7，Ubuntu1804-中配置静态网络地址的过程，ip-地址为-192-168-100-100-子网掩码为-255-255-255-0"><a href="#5-请写出-CentOS6-10，CentOS7-7，Ubuntu1804-中配置静态网络地址的过程，ip-地址为-192-168-100-100-子网掩码为-255-255-255-0" class="headerlink" title="5. 请写出 CentOS6.10，CentOS7.7，Ubuntu1804 中配置静态网络地址的过程，ip 地址为 192.168.100.100 子网掩码为 255.255.255.0"></a>5. 请写出 CentOS6.10，CentOS7.7，Ubuntu1804 中配置静态网络地址的过程，ip 地址为 192.168.100.100 子网掩码为 255.255.255.0</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">CentOS6 和 CentOS7 :</span><br><span class="line"> </span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network-scripts/ifcfg-eth0</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-eth0</span></span><br><span class="line">TYPE=<span class="string">"Ethernet"</span></span><br><span class="line">BOOTPROTO=<span class="string">"static"</span></span><br><span class="line">NAME=<span class="string">"eth0"</span></span><br><span class="line">DEVICE=<span class="string">"eth0"</span></span><br><span class="line">ONBOOT=<span class="string">"yes"</span></span><br><span class="line">IPADDR=192.168.100.100</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.100.1</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># service network restart</span></span><br><span class="line">Shutting down interface eth0:                              [  OK  ]</span><br><span class="line">Shutting down loopback interface:                          [  OK  ]</span><br><span class="line">Bringing up loopback interface:                            [  OK  ]</span><br><span class="line">Bringing up interface eth0:  </span><br><span class="line">Determining IP information <span class="keyword">for</span> eth0... <span class="keyword">done</span>.</span><br><span class="line">                                                           [  OK  ]</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ubuntu1804 :</span><br><span class="line"></span><br><span class="line">root@localhost:~<span class="comment">#   </span></span><br><span class="line">root@localhost:~<span class="comment"># cat /etc/netplan/50-cloud-init.yaml </span></span><br><span class="line"><span class="comment"># This file is generated from information provided by</span></span><br><span class="line"><span class="comment"># the datasource.  Changes to it will not persist across an instance.</span></span><br><span class="line"><span class="comment"># To disable cloud-init's network configuration capabilities, write a file</span></span><br><span class="line"><span class="comment"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:</span></span><br><span class="line"><span class="comment"># network: &#123;config: disabled&#125;</span></span><br><span class="line">network:</span><br><span class="line">    version: 2</span><br><span class="line">    renderer: networkd</span><br><span class="line">    ethernets:</span><br><span class="line">        eth0:</span><br><span class="line">            dhcp4: <span class="literal">false</span></span><br><span class="line">            addresses:</span><br><span class="line">                - 192.168.100.100/24</span><br><span class="line">            gateway4: 192.168.100.1</span><br><span class="line">            nameservers:</span><br><span class="line">                addresses: [223.5.5.5, 114.114.114.114]</span><br><span class="line">root@localhost:~<span class="comment">#  </span></span><br><span class="line">root@localhost:~<span class="comment"># netplan apply </span></span><br><span class="line">root@localhost:~<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h4 id="6-请说出为什么在-ping-服务器地址时不需要指明端口号的原因"><a href="#6-请说出为什么在-ping-服务器地址时不需要指明端口号的原因" class="headerlink" title="6. 请说出为什么在 ping 服务器地址时不需要指明端口号的原因"></a>6. 请说出为什么在 ping 服务器地址时不需要指明端口号的原因</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">icmp协议是IP层的附属协议，是介于IP层和TCP层之间的协议，一般认为属于IP层协议。IP协议用它来与其他主机或路由器交换错误报文和其他的一些网络情况,</span><br><span class="line">以此不需要端口</span><br></pre></td></tr></table></figure></div>

<h4 id="7-使用-awk-统计统计处理以下文件中每种域名出现的次数"><a href="#7-使用-awk-统计统计处理以下文件中每种域名出现的次数" class="headerlink" title="7. 使用 awk 统计统计处理以下文件中每种域名出现的次数"></a>7. 使用 awk 统计统计处理以下文件中每种域名出现的次数</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">http://www.baidu.com/index.html</span><br><span class="line">http://www.baidu.com/1.html</span><br><span class="line">http://post.baidu.com/index.html</span><br><span class="line">http://mp3.baidu.com/index.html</span><br><span class="line">http://www.baidu.com/3.html</span><br><span class="line">ftp://files.github.io/k8s.img</span><br><span class="line">http://post.baidu.com/2.html</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi file.txt </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat file.txt </span></span><br><span class="line">http://www.baidu.com/index.html</span><br><span class="line">http://www.baidu.com/1.html</span><br><span class="line">http://post.baidu.com/index.html</span><br><span class="line">http://mp3.baidu.com/index.html</span><br><span class="line">http://www.baidu.com/3.html</span><br><span class="line">ftp://files.github.io/k8s.img</span><br><span class="line">http://post.baidu.com/2.html</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat file.txt |awk -F'/' '&#123;a[$3]++&#125;END&#123;for(i in a)&#123;print i,a[i]&#125;&#125;'</span></span><br><span class="line">www.baidu.com 3</span><br><span class="line">files.github.io 1</span><br><span class="line">post.baidu.com 2</span><br><span class="line">mp3.baidu.com 1</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h4 id="8-CentOS7-6-系统中如何禁用-firewalld-服务？-禁用-firewalld-后，请写出-iptables-规则，要求仅对外开放-TCP-协议的-22、80、443-端口-配置生效后，如何才能确保系统重启后自动完成刚才的-iptables-规则配置？"><a href="#8-CentOS7-6-系统中如何禁用-firewalld-服务？-禁用-firewalld-后，请写出-iptables-规则，要求仅对外开放-TCP-协议的-22、80、443-端口-配置生效后，如何才能确保系统重启后自动完成刚才的-iptables-规则配置？" class="headerlink" title="8. CentOS7.6 系统中如何禁用 firewalld 服务？ 禁用 firewalld 后，请写出 iptables 规则，要求仅对外开放 TCP 协议的 22、80、443 端口; 配置生效后，如何才能确保系统重启后自动完成刚才的 iptables 规则配置？"></a>8. CentOS7.6 系统中如何禁用 firewalld 服务？ 禁用 firewalld 后，请写出 iptables 规则，要求仅对外开放 TCP 协议的 22、80、443 端口; 配置生效后，如何才能确保系统重启后自动完成刚才的 iptables 规则配置？</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">禁用 firewalld :</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl stop firewalld </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl disable firewalld</span></span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -vnL</span></span><br><span class="line">Chain INPUT (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">配置防火墙规则 :</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -p tcp -m multiport --dport 22,80,443 -j ACCEPT</span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -I INPUT 1 -m state --state ESTABLISHED,RELATED -j ACCEPT</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -j REJECT</span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -vnL</span></span><br><span class="line">Chain INPUT (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line">  123  9720 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED</span><br><span class="line">  207 17208 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 22,80,443</span><br><span class="line">    3   234 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 17 packets, 1660 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables-save -c &gt; /etc/sysconfig/iptables</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum install -y iptables-services</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * extras: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * updates: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line">Package iptables-services-1.4.21-33.el7.x86_64 already installed and latest version</span><br><span class="line">Nothing to <span class="keyword">do</span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl enable iptables</span></span><br><span class="line">Created symlink from /etc/systemd/system/basic.target.wants/iptables.service to /usr/lib/systemd/system/iptables.service.</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl restart iptables</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h4 id="9-请简述-httpd-的三种工作模式以及他们的特点（prefork-worker-Event）"><a href="#9-请简述-httpd-的三种工作模式以及他们的特点（prefork-worker-Event）" class="headerlink" title="9. 请简述 httpd 的三种工作模式以及他们的特点（prefork, worker, Event）"></a>9. 请简述 httpd 的三种工作模式以及他们的特点（prefork, worker, Event）</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.prefork : 预派生模式，有一个主控制进程，然后生成多个子进程，使用select模型，最大并发1024，每个子进程有一个独立</span><br><span class="line">的线程响应用户请求，相对比较占用内存，但是比较稳定，可以设置最大和最小进程数，是最古老的一种模式，也是最稳定的模式，  </span><br><span class="line">适用于访问量不是很大的场景。 优点：稳定 缺点：慢，占用资源，1024个进程不适用于高并发场景</span><br><span class="line"></span><br><span class="line">2.worker  ：一种多进程和多线程混合的模型，有一个控制进程，启动多个子进程，每个子进程里面包含固定的线程，使用线程来  </span><br><span class="line">处理请求，当线程不够使用的时候会再启动一个新的子进程，然后在进程里面再启动线程处理请求，由于其使用了线程处理请求，</span><br><span class="line">因此可以承受更高的并发。 优点：相比prefork 占用的内存较少，可以同时处理更多的请求。</span><br><span class="line">缺点：使用keepalive的长连接方式，某个线程会一直被占据，即使没有传输数据，也需要一直等待到超时才会被释放。如果过多的</span><br><span class="line">线程，被这样占据，也会导致在高并发场景下的无服务线程可用。（该问题在prefork模式下，同样会发生）</span><br><span class="line"></span><br><span class="line">3.event   ：Apache中最新的模式，2012年发布的apache 2.4.X系列正式支持event 模型，属于事件驱动模型(epoll)，每个进程</span><br><span class="line">响应多个请求，在现在版本里的已经是稳定可用的模式。它和worker模式很像，最大的区别在于，它解决了 keepalive 场景下，长</span><br><span class="line">期被占用的线程的资源浪费问题（某些线程因为被keepalive，空挂在哪里等待，中间几乎没有请求过来，甚至等到超时）。event MPM</span><br><span class="line">中，会有一个专门的线程来管理这些keepalive类型的线程，当有真实请求过来的时候，将请求传递给服务线程，执行完毕后，又允许它</span><br><span class="line">释放。这样增强了高并发场景下的请求处理能力。 优点：单线程响应多请求，占据更少的内存，高并发下表现更优秀，会有一个专门的线</span><br><span class="line">程来管理keep-alive类型的线程，当有真实请求过来的时候，将请求传递给服务线程，执行完毕后，又允许它释放 缺点：没有线程安全控</span><br><span class="line">制</span><br></pre></td></tr></table></figure></div>

<h4 id="10-CentOS7-系统有几个运行级别？-分别是什么？-如何将默认运行级别调整为字符界面？"><a href="#10-CentOS7-系统有几个运行级别？-分别是什么？-如何将默认运行级别调整为字符界面？" class="headerlink" title="10. CentOS7 系统有几个运行级别？ 分别是什么？ 如何将默认运行级别调整为字符界面？"></a>10. CentOS7 系统有几个运行级别？ 分别是什么？ 如何将默认运行级别调整为字符界面？</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CentOS7 中有 5 中运行级别，分别是 0 shutdown.target，1 emergency.target， 2 rescure.target，3  multi-user.target，</span><br><span class="line">5  graphical.target。</span><br><span class="line"></span><br><span class="line">设置默认运行级别可使用 systemctl set-default multi-user.target 命令完成</span><br></pre></td></tr></table></figure></div>

<h3 id="扩展题"><a href="#扩展题" class="headerlink" title="扩展题"></a>扩展题</h3><h4 id="1-使用-shell-脚本完成在一台-CentOS7-中编译安装-httpd2-4-39-和-php7-3-5-的-fpm-模式，实现-httpd-通过-socket-与-fpm-通信，-响应-phpinfo-信息页面请求，请写出详细过程。"><a href="#1-使用-shell-脚本完成在一台-CentOS7-中编译安装-httpd2-4-39-和-php7-3-5-的-fpm-模式，实现-httpd-通过-socket-与-fpm-通信，-响应-phpinfo-信息页面请求，请写出详细过程。" class="headerlink" title="1. 使用 shell 脚本完成在一台 CentOS7 中编译安装 httpd2.4.39 和 php7.3.5 的 fpm 模式，实现 httpd 通过 socket 与 fpm 通信， 响应 phpinfo 信息页面请求，请写出详细过程。"></a>1. 使用 shell 脚本完成在一台 CentOS7 中编译安装 httpd2.4.39 和 php7.3.5 的 fpm 模式，实现 httpd 通过 socket 与 fpm 通信， 响应 phpinfo 信息页面请求，请写出详细过程。</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat phpinstall.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1. choose a installation working path</span></span><br><span class="line">workingPath=<span class="variable">$1</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$workingPath</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2. set variables for software version</span></span><br><span class="line">httpdVersion=2.4.39</span><br><span class="line">aprVersion=1.7.0</span><br><span class="line">aprUtilVersion=1.6.1</span><br><span class="line">phpVersion=7.3.5</span><br><span class="line"></span><br><span class="line"><span class="comment">#3. set function for compile installation</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">install_php</span></span>()&#123;</span><br><span class="line">	<span class="comment">#3.1 Install Dependencies packages</span></span><br><span class="line">    yum clean all</span><br><span class="line">    yum makecache</span><br><span class="line"></span><br><span class="line">	yum install -y epel-release wget libxml2-devel gcc pcre-devel openssl-devel expat-devel autoconf libtool gcc-c++</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#3.2 download source packages from official mirror, tar packages</span></span><br><span class="line">    wget https://www.php.net/distributions/php-<span class="variable">$&#123;phpVersion&#125;</span>.tar.bz2</span><br><span class="line">	wget http://mirrors.tuna.tsinghua.edu.cn/apache/apr/apr-<span class="variable">$&#123;aprVersion&#125;</span>.tar.gz</span><br><span class="line">	wget http://mirrors.tuna.tsinghua.edu.cn/apache/apr/apr-util-<span class="variable">$&#123;aprUtilVersion&#125;</span>.tar.gz</span><br><span class="line"> 	wget https://mirrors.tuna.tsinghua.edu.cn/apache/httpd/httpd-<span class="variable">$&#123;httpdVersion&#125;</span>.tar.gz</span><br><span class="line">	tar xvf httpd-<span class="variable">$&#123;httpdVersion&#125;</span>.tar.gz</span><br><span class="line">	tar xvf apr-<span class="variable">$&#123;aprVersion&#125;</span>.tar.gz -C httpd-<span class="variable">$&#123;httpdVersion&#125;</span>/srclib/</span><br><span class="line">	tar xvf apr-util-<span class="variable">$&#123;aprUtilVersion&#125;</span>.tar.gz -C httpd-<span class="variable">$&#123;httpdVersion&#125;</span>/srclib/</span><br><span class="line">	<span class="built_in">cd</span> httpd-2.4.39/srclib/</span><br><span class="line">	mv apr-<span class="variable">$&#123;aprVersion&#125;</span> apr</span><br><span class="line">	mv apr-util-<span class="variable">$&#123;aprUtilVersion&#125;</span> apr-util</span><br><span class="line">	<span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.3 configure and make make install httpd</span></span><br><span class="line"></span><br><span class="line">	./configure --prefix=/usr/<span class="built_in">local</span>/httpd24 --<span class="built_in">enable</span>-so --<span class="built_in">enable</span>-ssl --<span class="built_in">enable</span>-cgi --<span class="built_in">enable</span>-rewrite --with-zlib --with-pcre --with-included-apr --<span class="built_in">enable</span>-modules=most --<span class="built_in">enable</span>-mpms-shared=all --with-mpm=prefork</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span>	</span><br><span class="line">		make &amp;&amp; make install</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">" make and make install"</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">#3.4 add apache user for httpd daemon</span></span><br><span class="line">	useradd -r apache -s /sbin/nologin </span><br><span class="line">     </span><br><span class="line">	<span class="comment">#3.5 modify the http configs</span></span><br><span class="line">    sed -i <span class="string">'s@User = daemon@User = apache@'</span> /usr/<span class="built_in">local</span>/httpd24/conf/httpd.conf</span><br><span class="line">	sed -i <span class="string">'s@Group = daemon@Group = apache@'</span> /usr/<span class="built_in">local</span>/httpd24/conf/httpd.conf</span><br><span class="line"></span><br><span class="line">cat &gt;&gt; /usr/<span class="built_in">local</span>/httpd24/conf/httpd.conf &lt;&lt;-EOF</span><br><span class="line">LoadModule proxy_module modules/mod_proxy.so</span><br><span class="line">LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so</span><br><span class="line">LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so</span><br><span class="line"></span><br><span class="line">ProxyRequests Off</span><br><span class="line">ProxyPassMatch ^/(.*\.php)$ unix:/var/run/php-fpm.sock|fcgi://localhost/usr/<span class="built_in">local</span>/httpd24/htdocs/</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;?php phpinfo(); ?&gt;'</span> &gt; /usr/<span class="built_in">local</span>/httpd24/htdocs/index.php</span><br><span class="line">	</span><br><span class="line">        <span class="comment">#3.6 set httpd path to run apachectl</span></span><br><span class="line">cat &gt; /etc/profile.d/httpd.sh &lt;&lt;-EOF</span><br><span class="line">PATH=/usr/<span class="built_in">local</span>/httpd24/bin:\<span class="variable">$PATH</span></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.7 configue make make install php-fpm</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">cd</span> <span class="variable">$workingPath</span></span><br><span class="line">	tar xf php-7.3.5.tar.bz2</span><br><span class="line">	<span class="built_in">cd</span> php-7.3.5</span><br><span class="line"></span><br><span class="line">	./configure --prefix=/usr/<span class="built_in">local</span>/php --<span class="built_in">enable</span>-mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --with-openssl --with-freetype-dir --with-jpeg-dir --with-png-dir --with-zlib --with-config-file-path=/usr/loca/php/etc --with-config-file-scan-dir=/usr/<span class="built_in">local</span>/php/etc/php.d --<span class="built_in">enable</span>-mbstring --<span class="built_in">enable</span>-xml --<span class="built_in">enable</span>-sockets --<span class="built_in">enable</span>-fpm --<span class="built_in">enable</span>-maintainer-zts --<span class="built_in">disable</span>-fileinfo</span><br><span class="line">	make -j 4</span><br><span class="line">	</span><br><span class="line">	make install</span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.8 config php-fpm</span></span><br><span class="line">	<span class="built_in">cd</span> /usr/<span class="built_in">local</span>/php/etc/</span><br><span class="line">	cp php-fpm.conf.default php-fpm.conf</span><br><span class="line">	<span class="built_in">cd</span> php-fpm.d/</span><br><span class="line">    	cp www.conf.default www.conf</span><br><span class="line">	<span class="built_in">cd</span> /root/php-7.3.5/sapi/fpm</span><br><span class="line">	cp init.d.php-fpm /etc/init.d/php-fpm</span><br><span class="line">	chmod 755 /etc/init.d/php-fpm</span><br><span class="line"></span><br><span class="line">	sed -i <span class="string">'s@user = nobody@user = apache@'</span> /usr/<span class="built_in">local</span>/php/etc/php-fpm.d/www.conf</span><br><span class="line">    	sed -i <span class="string">'s@group = nobody@group = apache@'</span> /usr/<span class="built_in">local</span>/php/etc/php-fpm.d/www.conf</span><br><span class="line">	sed -i <span class="string">'s@listen = 127.0.0.1:9000@listen = /var/run/php-fpm.sock@'</span> /usr/<span class="built_in">local</span>/php/etc/php-fpm.d/www.conf</span><br><span class="line">	sed -i <span class="string">'s@;listen.mode = 0660@listen.mode = 0666@'</span> /usr/<span class="built_in">local</span>/php/etc/php-fpm.d/www.conf	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#4. remove the installed software</span></span><br><span class="line"><span class="function"><span class="title">remove_php</span></span>()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"remove php softwares"</span></span><br><span class="line">	rm -rf /usr/<span class="built_in">local</span>/httpd24</span><br><span class="line">    rm -rf /usr/<span class="built_in">local</span>/php</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#5. choose functions</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$2</span> <span class="keyword">in</span></span><br><span class="line">install)</span><br><span class="line">     install_php</span><br><span class="line">     ;;</span><br><span class="line">remove)</span><br><span class="line">     remove_php</span><br><span class="line">     ;;</span><br><span class="line">*)</span><br><span class="line">     <span class="built_in">echo</span> <span class="string">"Useage: <span class="variable">$0</span> <span class="variable">$1</span> install | remove"</span></span><br><span class="line">     ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># apachectl start </span></span><br><span class="line">[root@localhost ~]<span class="comment"># service php-fpm start</span></span><br><span class="line">[root@localhost ~]<span class="comment"># curl 127.0.0.1/index.php</span></span><br></pre></td></tr></table></figure></div>

<h4 id="2-httpd-服务器的访问日志保存在容量为-1T-的-dev-sdb-磁盘中，对应的挂载路径为-data-log，编写一个-shell-脚本，每隔一个小时测试一下该磁盘的使用率是否超过60-，如果超过立刻将-2-天之前的日志移动到远程服务器-172-18-0-100-服务器上，移动完成后，如果磁盘空间使用率依旧大于-70-则发邮件给-1794379915-qq-com-提示报警。请写出操作的主要过程。"><a href="#2-httpd-服务器的访问日志保存在容量为-1T-的-dev-sdb-磁盘中，对应的挂载路径为-data-log，编写一个-shell-脚本，每隔一个小时测试一下该磁盘的使用率是否超过60-，如果超过立刻将-2-天之前的日志移动到远程服务器-172-18-0-100-服务器上，移动完成后，如果磁盘空间使用率依旧大于-70-则发邮件给-1794379915-qq-com-提示报警。请写出操作的主要过程。" class="headerlink" title="2. httpd 服务器的访问日志保存在容量为 1T 的 /dev/sdb 磁盘中，对应的挂载路径为/data/log，编写一个 shell 脚本，每隔一个小时测试一下该磁盘的使用率是否超过60%，如果超过立刻将 2 天之前的日志移动到远程服务器 172.18.0.100 服务器上，移动完成后，如果磁盘空间使用率依旧大于 70%, 则发邮件给 1794379915@qq.com 提示报警。请写出操作的主要过程。"></a>2. httpd 服务器的访问日志保存在容量为 1T 的 /dev/sdb 磁盘中，对应的挂载路径为/data/log，编写一个 shell 脚本，每隔一个小时测试一下该磁盘的使用率是否超过60%，如果超过立刻将 2 天之前的日志移动到远程服务器 172.18.0.100 服务器上，移动完成后，如果磁盘空间使用率依旧大于 70%, 则发邮件给 <a href="mailto:1794379915@qq.com">1794379915@qq.com</a> 提示报警。请写出操作的主要过程。</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">配置邮件:</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum install mailx sendmail -y </span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.huaweicloud.com</span><br><span class="line"> * extras: mirrors.huaweicloud.com</span><br><span class="line"> * updates: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line">Package mailx-12.5-19.el7.x86_64 already installed and latest version</span><br><span class="line">Package sendmail-8.14.7-5.el7.x86_64 already installed and latest version</span><br><span class="line">Nothing to <span class="keyword">do</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/mail.rc </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># tail -n 4 /etc/mail.rc </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> from=1794379915@qq.com smtp=<span class="string">"smtp.qq.com"</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth-user=<span class="string">"1794379915@qq.com"</span> smtp-auth-password=<span class="string">"whtobh67sdfsgroobf"</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth=login</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mail -s 'warning' 1794379915@qq.com</span></span><br><span class="line">hello gordon</span><br><span class="line">.</span><br><span class="line">EOT</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">开启远程免密登录功能:</span><br><span class="line">[root@localhost ~]<span class="comment"># ssh-keygen </span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:PjMhaz8iVK6Hc6XcawNbHQS2svOe0qPAKPW5GlVIjgs root@localhost.localdomain</span><br><span class="line">The key is randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|    .   o.       |</span><br><span class="line">|   + . . ..      |</span><br><span class="line">|E . o o ..       |</span><br><span class="line">| . . ..o  .      |</span><br><span class="line">|  o .o+ S. .     |</span><br><span class="line">| . =..o*o..      |</span><br><span class="line">|. o.=+oO*        |</span><br><span class="line">| . .=+OoB=       |</span><br><span class="line">|  ...=.===       |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># ssh-copy-id 172.18.0.100</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">"/root/.ssh/id_rsa.pub"</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">root@192.168.7.129 is password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   <span class="string">"ssh '172.18.0.100'"</span></span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ssh 172.18.0.100</span></span><br><span class="line">Last login: Mon Oct 28 14:31:58 2019 from 172.18.0.200</span><br><span class="line">[root@localhost ~]<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line">Connection to 192.168.0.100 closed.</span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编写shell功能脚本：</span><br><span class="line">[root@localhost ~]<span class="comment"># vi scripts/checkdisk.sh </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat scripts/checkdisk.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1. get the disk pcent value</span></span><br><span class="line">DiskPcent=`df /dev/sdb1 --output=<span class="built_in">source</span>,pcent  | awk -F<span class="string">'[ ]*|%'</span>  <span class="string">'/^\/dev\/sd/ &#123;print  $2&#125;'</span>`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.  judge DiskPcent and copy the file </span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$DiskPcent</span> -gt 70 ] ;<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"warning copy file !!"</span></span><br><span class="line">	find /data/<span class="built_in">log</span> -mtime +2 -<span class="built_in">exec</span> scp &#123;&#125; 192.168.7.129:/root \;</span><br><span class="line">    find /data/<span class="built_in">log</span> -mtime +2 -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.  judge DiskPcent again and send mail to the option manager!</span></span><br><span class="line">DiskPcent=`df /dev/sdb1 --output=<span class="built_in">source</span>,pcent  | awk -F<span class="string">'[ ]*|%'</span>  <span class="string">'/^\/dev\/sd/ &#123;print  $2&#125;'</span>`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$DiskPcent</span> -gt 70 ] ;<span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">"warning devsdb is full"</span> </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">" please check the data disk"</span> | mail -s <span class="string">'warning'</span> 1794379915@qq.com</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#5. finish check disk one time</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"check over!!!!"</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">曹志明</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://caohziming.net/post/14562.html">https://caohziming.net/post/14562.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://caohziming.net">Miij's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/post/31024.html"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Nginx编译安装</span></div></a></div><div class="next-post pull_right"><a href="/post/15747.html"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>三次握手及四次挥手</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/post/15747.html" title="三次握手及四次挥手"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-07</div><div class="relatedPosts_title">三次握手及四次挥手</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 曹志明</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://caozhiming.net" target="_blank" rel="noopener">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="true" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/click_heart.js"></script></body></html>